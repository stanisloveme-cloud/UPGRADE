name: Diagnose Application
on: 
  workflow_dispatch:

jobs:
  diagnose:
    runs-on: ubuntu-latest
    steps:
      - name: Fetch Remote Logs
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            echo "=== RUNNING CONTAINERS ==="
            docker ps -a
            
            echo "--- BACKEND LOGS (Last 300 lines) ---"
            docker logs --tail 300 upgrade-crm-app-1 2>&1 || echo "Backend logs not found"
            
            echo "--- FRONTEND LOGS (Last 100 lines) ---"
            docker logs --tail 100 upgrade-crm-frontend-1 2>&1 || echo "Frontend logs not found"
